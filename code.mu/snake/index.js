!function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}i.r(t);var n=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.colNumber=t,this.rowNumber=i,this.playField=this._getPlayField(),this.coordsSnake=[],this.deltaCord={deltaCol:0,deltaRow:-1},this.prevDirect="up",this.newPieceCoord=null,this.score=0,this.isStart=!0,this.isOver=!1,this._setNewCoordSnake(this._getDefaultHeadSnakeCoord()),this._drawSnakeCords(),this._setNewPieceCord(),this.drawCoordsInPlayField()}var t,i,n;return t=e,(i=[{key:"drawCoordsInPlayField",value:function(){this._drawSnakeCords(),this._drawNewPieceCord()}},{key:"moveSnakeInPlayField",value:function(){this._cleanPlayField(),this._changeSnakeCoords(),this.drawCoordsInPlayField()}},{key:"getState",value:function(){return{playField:JSON.parse(JSON.stringify(this.playField)),score:this.score,isStart:this.isStart,isOver:this.isOver}}},{key:"changeDeltaCord",value:function(e){switch(e){case 37:if("right"===this.prevDirect)return;this.deltaCord={deltaCol:-1,deltaRow:0},this.prevDirect="left";break;case 38:if("down"===this.prevDirect)return;this.deltaCord={deltaCol:0,deltaRow:-1},this.prevDirect="up";break;case 39:if("left"===this.prevDirect)return;this.deltaCord={deltaCol:1,deltaRow:0},this.prevDirect="right";break;case 40:if("up"===this.prevDirect)return;this.deltaCord={deltaCol:0,deltaRow:1},this.prevDirect="down"}}},{key:"hasBorderCollision",value:function(){var e=this.coordsSnake.slice(0,1)[0],t=e.row,i=e.col,r=this.deltaCord,n=r.deltaCol,o=r.deltaRow;return void 0===this.playField[t+o]||void 0===this.playField[t+o][i+n]}},{key:"hasSnakeCollision",value:function(){var e=this.coordsSnake.slice(0,1)[0],t=e.row,i=e.col,r=this.deltaCord,n=r.deltaCol,o=r.deltaRow;return 2===this.playField[t+o][i+n]}},{key:"hasNewPieceCollision",value:function(){var e=this.coordsSnake[0],t=e.row,i=e.col,r=this.newPieceCoord,n=r.row,o=r.col;return n===t&&o===i}},{key:"newPieceHandler",value:function(){this._setNewCoordSnake(this._getCoordNewPieceInSnake()),this._setNewPieceCord(),this._updateScore()}},{key:"_drawSnakeCords",value:function(){var e=this;this.coordsSnake.forEach((function(t,i){var r=t.row,n=t.col;e.playField[r][n]=0!==i?2:1}))}},{key:"_drawNewPieceCord",value:function(){var e=this.newPieceCoord,t=e.row,i=e.col;this.playField[t][i]=3}},{key:"_cleanPlayField",value:function(){var e=this;this.coordsSnake.forEach((function(t){var i=t.row,r=t.col;e.playField[i][r]=0}))}},{key:"_getPlayField",value:function(){for(var e=[],t=0;t<this.rowNumber;t++)e.push(Array(this.colNumber).fill(0));return e}},{key:"_getDefaultHeadSnakeCoord",value:function(){return{row:Math.floor(this.rowNumber/2),col:Math.floor(this.colNumber/2)}}},{key:"_setNewCoordSnake",value:function(e){this.coordsSnake.push(e)}},{key:"_changeSnakeCoords",value:function(){this._changeCoordsOnPrev(),this._changeHeadCoord()}},{key:"_changeCoordsOnPrev",value:function(){for(var e=JSON.parse(JSON.stringify(this.coordsSnake)),t=e.length-1;t>0;t--)e[t]=e[t-1];this.coordsSnake=e}},{key:"_changeHeadCoord",value:function(){var e=JSON.parse(JSON.stringify(this.coordsSnake)),t=e[0],i=t.row,r=t.col,n=this.deltaCord,o=n.deltaCol,a=n.deltaRow;e[0].row=i+a,e[0].col=r+o,this.coordsSnake=e}},{key:"_getRandomCoord",value:function(){var e=this.colNumber-1,t=this.rowNumber-1;return{row:Math.floor(Math.random()*(t-0+1))+0,col:Math.floor(Math.random()*(e-0+1))+0}}},{key:"_setNewPieceCord",value:function(){var e=this._getRandomCoord();this._isCellEmpty(e)?this.newPieceCoord=e:this._setNewPieceCord()}},{key:"_isCellEmpty",value:function(e){var t=e.row,i=e.col;return 0===this.playField[t][i]}},{key:"_getCoordNewPieceInSnake",value:function(){var e=this.coordsSnake.slice(-1)[0];return{row:e.row,col:e.col}}},{key:"_updateScore",value:function(){this.score++}}])&&r(t.prototype,i),n&&r(t,n),e}();function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t,i,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentElem=t,this.width=i,this.height=r,this.row=o,this.col=n,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.playFieldBorderWidth=4,this.playFieldX=this.playFieldBorderWidth,this.playFieldY=this.playFieldBorderWidth,this.playFieldWidth=this.width,this.playFieldHeight=9*this.height/10,this.playFieldInnerWidth=this.playFieldWidth-2*this.playFieldBorderWidth,this.playFieldInnerHeight=this.playFieldHeight-2*this.playFieldBorderWidth,this.cellWidth=Math.floor(this.playFieldInnerWidth/this.col),this.cellHieght=Math.floor(this.playFieldInnerHeight/this.row),this.panelX=this.playFieldWidth/2,this.panelY=this.playFieldHeight+10,this.panelWidth=this.playFieldWidth,this.panelHeight=this.playFieldHeight/10,this.parentElem.appendChild(this.canvas)}var t,i,r;return t=e,(i=[{key:"renderMainScreen",value:function(e){var t=e.playField,i=e.score;this._clearScreen(),this._renderPlayField(t),this._renderPanel(i)}},{key:"renderStartScreen",value:function(){this.context.fillStyle="white",this.context.font='18px "Press Start 2P"',this.context.textAlign="center",this.context.textBaseline="middle",this.context.fillText("Press ENTER to Start",this.width/2,this.height/2)}},{key:"renderGameOverScreen",value:function(e){var t=e.score;this._clearScreen(),this.context.fillStyle="white",this.context.font='18px "Press Start 2P"',this.context.textAlign="center",this.context.textBaseline="middle",this.context.fillText("GAME OVER",this.width/2,this.height/2-48),this.context.fillText("Score: ".concat(t),this.width/2,this.height/2),this.context.fillText("Press F5 to restart",this.width/2,this.height/2+48)}},{key:"_clearScreen",value:function(){this.context.clearRect(0,0,this.width,this.height)}},{key:"_renderPlayField",value:function(e){for(var t=0;t<e.length;t++)for(var i=e[t],r=0;r<i.length;r++){var n=i[r];n&&this._renderCell(this.playFieldX+r*this.cellWidth,this.playFieldY+t*this.cellHieght,this.cellWidth,this.cellHieght,n)}this.context.strokeStyle="white",this.context.lineWidth=this.playFieldBorderWidth,this.context.strokeRect(0,0,this.playFieldWidth,this.playFieldHeight)}},{key:"_renderCell",value:function(e,t,i,r,n){this._setColorCell(n),this.context.strokeStyle="black",this.context.lineWidth=2,this.context.fillRect(e,t,i,r),this.context.strokeRect(e,t,i,r)}},{key:"_setColorCell",value:function(e){switch(e){case 1:this.context.fillStyle="#FF8EC6";break;case 2:this.context.fillStyle="#2EFF68";break;case 3:this.context.fillStyle="#FF6347"}}},{key:"_renderPanel",value:function(e){this.context.textAlign="center",this.context.textBaseline="top",this.context.fillStyle="white",this.context.font='14px "Press Start 2P"',this.context.fillText("Score: ".concat(e),this.panelX,this.panelY)}}])&&o(t.prototype,i),r&&o(t,r),e}();function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.view=i,this.timerID=null,this.isStart=!0,document.addEventListener("keydown",this.handleKeyDown.bind(this)),this.view.renderStartScreen()}var t,i,r;return t=e,(i=[{key:"handleKeyDown",value:function(e){13===e.keyCode&&this.isStart?(this.view.renderMainScreen(this.game.getState()),this.startTimer(),this.isStart=!1):this.game.changeDeltaCord(e.keyCode)}},{key:"startTimer",value:function(){var e=this;this.timerID=setInterval((function(){e.game.hasBorderCollision()||e.game.hasSnakeCollision()?(window.clearInterval(e.timerID),e.view.renderGameOverScreen(e.game.getState())):e.game.hasNewPieceCollision()?(e.game.newPieceHandler(),e.game.moveSnakeInPlayField(),e.view.renderMainScreen(e.game.getState())):(e.game.moveSnakeInPlayField(),e.view.renderMainScreen(e.game.getState()))}),300)}}])&&l(t.prototype,i),r&&l(t,r),e}(),h=document.querySelector("#snake");new s(new n(21,15),new a(h,575,450,21,15))}]);